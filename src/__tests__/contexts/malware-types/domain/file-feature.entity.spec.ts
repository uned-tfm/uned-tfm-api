import { Primitives } from '../../../../contexts/shared/domain/value-objects/entity';
import { FieldValidationError } from '../../../../contexts/shared/domain/errors';
import {
  MalwareType,
  MalwareTypeProperties
} from '../../../../contexts/malware-types/domain/models/malware-type.entity';
import { MalwareTypeBuilder } from '../__mocks__/malware-type.builder';

describe('File feature entity', () => {
  let validMalwareType: MalwareType;

  beforeAll(() => {
    validMalwareType = MalwareTypeBuilder().build();
  });

  describe('Input validation', () => {
    it('should throw when is invalid', () => {
      expect(() =>
        MalwareType.create({
          malwareType: 'Arkei'
        } as unknown as Primitives<MalwareTypeProperties>)
      ).toThrow(FieldValidationError);
    });

    it('should create malware type when is valid', () => {
      const malwareType = MalwareType.create(validMalwareType.value);
      expect(malwareType).not.toBeNull();
      expect(malwareType).toMatchObject(validMalwareType);
    });
  });
});
